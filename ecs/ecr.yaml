---
AWSTemplateFormatVersion: 2010-09-09
Description: Deploy ECS Service Fargate
Parameters:
  Environment:
    Type: String
    Default: dev
    AllowedValues:
      - dev
      - qa
      - prod
  Project:
    Type: String
    Default: ito
  MicroServiceName:
    Type: String
    Default: dummy
    AllowedPattern: ^([a-z]|[0-9])*$
Resources:
  EcrXRay:
    Type: AWS::ECR::Repository
    Properties: 
      RepositoryName: !Sub ${Project}-${Environment}-x-ray
  EcrBatchTest:
    Type: AWS::ECR::Repository
    Properties: 
      RepositoryName: !Sub ${Project}-${Environment}-test-batch
  EcrRegistry1:
    Type: AWS::ECR::Repository
    Properties: 
      RepositoryName: !Sub ${Project}-${Environment}-${MicroServiceName}
Outputs:
  EcrXRayUri:
    Value:
      !Sub
        - ${repositoryUri}:latest
        - repositoryUri: !GetAtt EcrXRay.RepositoryUri
    Export:
      Name: !Sub ${Project}-${Environment}-EcrXRayUri
  EcrRegistryUri1:
    Value:
      !Sub
        - ${repositoryUri}:latest
        - repositoryUri: !GetAtt EcrRegistry1.RepositoryUri
    Export:
      Name: !Sub ${Project}-${Environment}-${MicroServiceName}-EcrUri